

CREATE TABLE `company` (
	`company_id` INT(11) NOT NULL,
	`company_name` varchar(50) NOT NULL,
	`audit_insert_date` DATETIME NOT NULL,
	`audit_update_date` DATETIME NULL DEFAULT NULL,
	`is_deleted` INT(1) ,
	PRIMARY KEY (`company_id`)
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;



CREATE TABLE `authority` (
	`authority_id` INT(11) NOT NULL,
	`authority_name` varchar(50) NOT NULL,
	`audit_insert_date` DATETIME NOT NULL,
	`audit_update_date` DATETIME NULL DEFAULT NULL,
	PRIMARY KEY (`authority_id`)
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;


CREATE TABLE `k_group` (
	`group_id` INT(11) NOT NULL,
	`group_name` VARCHAR(50) NOT NULL,
	`audit_insert_date` DATETIME NOT NULL,
	`audit_update_date` DATETIME NULL DEFAULT NULL,
	`company_id` INT(11) NOT NULL,
	PRIMARY KEY (`group_id`),
	INDEX `fk_comp_g` (`company_id`),
	CONSTRAINT `fk_comp_g` FOREIGN KEY (`company_id`) REFERENCES `company` (`company_id`)
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `group_authority`
(
  group_group_id int NOT NULL,
  authority_authority_id int NOT NULL,
  CONSTRAINT group_authority_pkey PRIMARY KEY (group_group_id, authority_authority_id),
  CONSTRAINT fk_authority_g FOREIGN KEY (authority_authority_id)  REFERENCES `authority` (authority_id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT fk_group_a FOREIGN KEY (group_group_id)  REFERENCES `k_group` (group_id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;


CREATE TABLE `user` (
	`user_id` INT(11) NOT NULL,
	`active` INT(11) NULL DEFAULT NULL,
	`email` VARCHAR(50) NOT NULL,
	`activation_keyword` VARCHAR(50) NULL DEFAULT NULL,
	`lastname` VARCHAR(50) NOT NULL,
	`firstname` VARCHAR(50) NOT NULL,
	`password` VARCHAR(50) NOT NULL,
	`audit_insert_date` DATETIME NULL DEFAULT NULL,
	`audit_update_date` DATETIME NULL DEFAULT NULL,
	`company_id` INT(11) NOT NULL,
	PRIMARY KEY (`user_id`),
	CONSTRAINT fk_comp FOREIGN KEY (company_id)
      REFERENCES `company` (company_id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

CREATE TABLE user_group
(
  group_group_id int NOT NULL,
  user_user_id int NOT NULL,
  CONSTRAINT group_user_pkey PRIMARY KEY (group_group_id, user_user_id),
  CONSTRAINT fk_user_g FOREIGN KEY (user_user_id)  REFERENCES `user` (user_id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT fk_group_u FOREIGN KEY (group_group_id) REFERENCES `k_group` (group_id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;


INSERT INTO `authority` (authority_id, authority_name,audit_insert_date) VALUES (1, 'ROLE_USER',now());
INSERT INTO `authority` (authority_id, authority_name,audit_insert_date) VALUES (2, 'ROLE_ADMIN',now());
#insert into `k_group`(group_id,group_name,audit_insert_date) values (1,'Administrator' , now());

#insert into `group_authority`(group_group_id,authority_authority_id) values (1,2);
